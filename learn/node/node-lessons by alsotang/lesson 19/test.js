var MongoClient = require('mongodb').MongoClient;
var DB_CONN_STR = 'mongodb://127.0.0.1:27017/white_';

var insertData = function(db, callback) {
    //连接到表
    console.log('1')
    var collection = db.collection('tb2');
    console.log('2')
    //插入数据
    var data = [
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22},
        {"name":'wilson001',"age":21},{"name":'wilson002',"age":22}
        ];
    // console.log(collection)
    collection.insert(data, function(err, result) {
        if(err)
        {
            console.log('Error:'+ err);
            return;
        }
        console.log('---')
        callback(result);
    });
}

MongoClient.connect(DB_CONN_STR, function(err, db) {
    console.log("连接成功！");
    console.log(DB_CONN_STR);
    insertData(db, function(result) {
        console.log(db);
        db.close();
    });
});